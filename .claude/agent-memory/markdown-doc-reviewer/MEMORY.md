# MMS Documentation Reviewer Memory

## Document Inventory
- `CLAUDE.md` -- Developer onboarding / AI assistant context (78 lines)
- `README.md` -- Slim project README with services table, architecture diagram, Quick Start, wiki links, security (~89 lines)
- `docs/wiki/Home.md` -- Wiki homepage with services table, architecture, inter-container access, doc links (~97 lines)
- `docs/wiki/Getting-Started.md` -- Prerequisites, install, configure, deploy (~77 lines)
- `docs/wiki/Configuration.md` -- Inventory variables, vault secrets, naming conventions (~84 lines)
- `docs/wiki/Proxmox-API-Setup.md` -- API token, role, permissions (~88 lines)
- `docs/wiki/Storage-Layout.md` -- Directory tree, NFS vs local, Immich volumes, SELinux (~64 lines)
- `docs/wiki/Traefik-Reverse-Proxy.md` -- DNS setup, routing config, verification (~57 lines)
- `docs/wiki/Security.md` -- Network, container, secrets security model (~22 lines)
- `docs/wiki/Common-Operations.md` -- Deploy, backup, restore, migrate, lint, dry-run (~84 lines)
- `docs/wiki/Backup-and-Restore.md` -- Config + API backups, encryption, restore (~166 lines)
- `docs/wiki/Auto-Deploy.md` -- Renovate, deploy keys, groups, schedules (~176 lines)
- `docs/wiki/Adding-a-New-Service.md` -- 5-step data-driven service guide (~68 lines)
- `docs/wiki/Troubleshooting.md` -- Systemd, containers, Quadlet, NFS, Podman, backups, autodeploy, Traefik, Immich (~328 lines)
- `docs/wiki/_Sidebar.md` -- Wiki sidebar navigation (~23 lines)
- `docs/wiki/_Footer.md` -- Wiki footer with repo link (~1 line)
- `.claude/agents/ansible-reviewer.md` -- Ansible review agent definition
- `.claude/agents/supply-chain-hygiene-reviewer.md` -- Supply-chain review agent definition
- `.claude/agents/markdown-doc-reviewer.md` -- This agent's definition

## Terminology Conventions
- "Rootless Podman" (capitalized)
- "Quadlet" (capitalized when referring to the systemd integration)
- "mms" (lowercase when referring to the user/service name)
- SELinux boolean: `virt_use_nfs` (NOT `container_use_nfs` -- fixed in commit a222f8c)
- Variable prefixes: `mms_` (global), `vault_` (secrets)
- Heading style: sentence case in both CLAUDE.md and README.md
- List markers: `-` consistently
- Code blocks: `bash` for shell, `yaml` for YAML, bare fence for ASCII art

## Known Documentation Gaps (as of 2026-02-17)
- No CHANGELOG documenting the UID/GID change from 1100 to 3000
- No migration guide for existing deployments
- Fedora version (43) not mentioned in prose of CLAUDE.md or README.md (only in inventory)
- No LICENSE or CONTRIBUTING files (acceptable for personal homelab)
- Dead variable `immich_port` in roles/immich/defaults/main.yml (no longer published)
- BLOCKER: Config backup path in all docs says `/home/mms/backups/` but code uses `/data/backups/config` (NFS)
- HIGH: Open Notebook completely absent from README and all wiki pages (but present in CLAUDE.md)
- HIGH: "Only Traefik publishes a host port" is wrong -- Plex also publishes 32400
- HIGH: Configuration.md vault table missing 4 variables (vm_password, backup_age, open_notebook x2)
- MEDIUM: Traefik wiki says `mms_traefik_domain` is in `group_vars/mms/vars.yml` (actually in `all`)
- MEDIUM: supply-chain-hygiene-reviewer.md services list missing Channels DVR, Navidrome, Open Notebook
- MEDIUM: Auto-Deploy example two-group config missing channels, navidrome, open-notebook
- LOW: Home.md Kometa URL uses `---` vs README's `---` (em dash)

## Source of Truth for Key Values
- UID/GID: `inventory/group_vars/all/vars.yml` lines 23-25 (currently 3000:3000)
- VM hostname: `inventory/group_vars/all/vars.yml` line 6 (`mms_vm_hostname`)
- VM display name: `inventory/group_vars/proxmox/vars.yml` line 18 (`mms_vm_name`)
- SSH public keys: `inventory/group_vars/all/vars.yml` lines 18-20 (`mms_vm_ssh_pubkeys` -- list)
- Traefik domain: `inventory/group_vars/all/vars.yml` line 50 (`mms_traefik_domain`) -- NOT in mms/vars.yml
- SELinux boolean: `roles/base_system/defaults/main.yml` line 20 (`virt_use_nfs`)
- Fedora version: `inventory/group_vars/proxmox/vars.yml` line 14 (Fedora 43)
- Services list: `inventory/group_vars/mms/vars.yml` lines 28-41 (does NOT include open-notebook or immich)
- Traefik routes: `inventory/group_vars/mms/vars.yml` lines 43-95 (`mms_traefik_routes`, includes open-notebook)
- Config backup dir: `inventory/group_vars/all/vars.yml` line 33 (`mms_backup_dir: /data/backups/config` -- NFS)
- Autodeploy defaults: `roles/autodeploy/defaults/main.yml` (groups, branch, timeout, retention)
- Autodeploy inventory override: `inventory/group_vars/mms/vars.yml` lines 97-122 (repo URL, groups)
- Backup role defaults: `roles/backup/defaults/main.yml` (config backup + API backup vars)
- Backup API services: `roles/backup/defaults/main.yml` lines 39-49 (`backup_api_*` prefix)
- NFS backups mount: `inventory/group_vars/mms/vars.yml` lines 23-25 (`/data/backups`)
- Open Notebook role: `roles/open_notebook/` (app + SurrealDB, two containers)
- Open Notebook ports: 8502 (Next.js frontend), 5055 (FastAPI backend)
- Plex publishes port 32400: `services/plex.yml` line 7 (`publish_ports: ["32400:32400"]`)

## Review History
- 2026-02-08: Full review of all .md files on fix/dry-run-issues branch (15 commits over main)
  - Found 3 files with stale UID 1100 (CLAUDE.md, README.md, supply-chain-hygiene-reviewer.md)
  - Found 1 missed Molecule fixture (testapp.yml PUID/PGID still 1100)
  - Found 1 stale ansible-reviewer memory entry (item #10 re: container_use_nfs)
  - SELinux boolean in CLAUDE.md already correctly says virt_use_nfs
  - README structure is comprehensive and well-organized
  - See review-findings.md for details
- 2026-02-08: Review of CLAUDE.md + README.md on feat/add-traefik-proxy branch
  - Traefik integration well-documented: architecture diagram, DNS setup, config, verification
  - No stale tailscale serve or port-publishing references in docs
  - tailscale role code correctly cleans up legacy serve (lines 44-52)
  - ASCII diagram line 32 is 1 char too wide (formatting bug)
  - README line 106: stale `vault_backup_age_public_key` (pre-existing, not Traefik-related)
  - CLAUDE.md missing `mms_traefik_domain`/`mms_traefik_routes` in Conventions section
- 2026-02-09: Review of Auto-Deploy section on feat/renovate-autodeploy branch
  - Per-group `autodeploy_groups` feature well-documented with examples
  - Variable table matches role defaults exactly
  - deploy-services.yml `deploy_services` filtering logic verified correct
  - Grammar fix needed on line 531 ("for that group's timer fires")
  - CLAUDE.md needs autodeploy role added to roles list and Architecture section
  - Autodeploy variable naming (bare vs mms_ prefix) could use a clarifying note
  - Missing troubleshooting/rollback/disable guidance (backlog items)
  - See review-findings.md for details
- 2026-02-10: Full review of all .md files on feat/multi-ssh-keys branch (9 commits over main)
  - `mms_vm_hostname`/`mms_vm_name` split not documented in CLAUDE.md or README.md
  - `mms_vm_ssh_pubkeys` (list) not reflected in README Quick Start (still says singular "SSH public key")
  - README Quick Start step 2 file descriptions stale (VM specs moved to group_vars/all)
  - CLAUDE.md Conventions missing: variable split, SSH keys list, Tmpfs/NoNewPrivileges, Jellyfin image
  - supply-chain-hygiene-reviewer.md missing Channels DVR and Navidrome
  - CLAUDE.md roles list now correctly includes autodeploy (prior gap resolved)
  - README backup variable name now correct (`mms_backup_age_public_key`, prior gap resolved)
  - Immich templates all have Tmpfs=/run:U (prior ansible-reviewer item #27 resolved)
  - See review-findings.md for details
- 2026-02-11: Review of all .md files on fix/sabnzbd-ini-race-condition branch (7 commits over main)
  - API backup system (mms-api-backup timer/service/script) entirely undocumented in README
  - `/data/backups/` NFS mount missing from storage layout diagram
  - Prerequisites missing "backups" in NFS exports list
  - CLAUDE.md missing backup architecture bullet and INI race/whitelist/backup_api conventions
  - Variable rename api_backup_* -> backup_api_* already correct in code, no stale doc refs
  - After=network-online.target fix correctly applied in both service templates
  - Inter-container access table is well-structured addition
  - See review-findings.md for details
- 2026-02-11: Review of all .md files on fix/base-system-packages branch (6 commits over main)
  - bpytop->btop: no public doc references; only agent memory files were stale
  - movies4k removal: README diagram complete/movies4k line correctly removed by branch
  - Immich /upload->/data mount: no doc references to container-internal mount path
  - Immich media subdirs + .immich markers: internal detail, no doc impact
  - Deploy resilience (block/rescue for Immich/Traefik): undocumented behavioral change
  - CLAUDE.md Conventions should note deploy resilience pattern
  - See review-findings.md for details
- 2026-02-11: Review of all .md files on feat/immich-split-volumes branch (1 commit over main)
  - Immich three-mount overlay: local SSD base at /data:Z, NFS overlays for upload/ and library/
  - README Storage Layout missing /home/mms/config/immich/media/ and NFS/local distinction
  - README Storage Layout /data/photos/ comment stale ("uploads" should be "user content")
  - CLAUDE.md Architecture Immich bullet missing volume split
  - CLAUDE.md Conventions missing Immich three-mount overlay pattern
  - README Backup section missing note about excluding regenerable content
  - README Migrate section missing note about rsync skipping regenerable content
  - Backup script --exclude='immich/media' correctly excludes local generated content
  - Migrate rsync excludes match immich_local_dirs (thumbs, encoded-video, profile, backups)
  - See review-findings.md for details
- 2026-02-17: Full review of all .md files on feat/open-notebook branch (4 commits over main)
  - Docs restructured: README slim, full content in docs/wiki/ (11 pages + sidebar/footer)
  - CLAUDE.md correctly updated with Open Notebook (services, roles)
  - BLOCKER: Config backup path wrong everywhere (/home/mms/backups/ vs /data/backups/config)
  - HIGH: Open Notebook absent from README and all wiki pages
  - HIGH: "Only Traefik publishes host port" wrong (Plex publishes 32400)
  - HIGH: Configuration.md vault table missing 4 variables
  - MEDIUM: Traefik doc wrong about mms_traefik_domain location
  - See review-findings.md for details
